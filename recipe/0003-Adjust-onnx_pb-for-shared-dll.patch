From d399b6260c51a86211cfbe25224e64a69d0bf3a2 Mon Sep 17 00:00:00 2001
From: Mark Harfouche <mark.harfouche@gmail.com>
Date: Sat, 11 Nov 2023 21:38:53 -0500
Subject: [PATCH 3/3] Adjust onnx_pb for shared dll

---
 onnx/onnx_pb.h | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/onnx/onnx_pb.h b/onnx/onnx_pb.h
index 0aab3e26..9f95c80a 100644
--- a/onnx/onnx_pb.h
+++ b/onnx/onnx_pb.h
@@ -41,10 +41,10 @@
 //
 // This solution is similar to
 // https://github.com/pytorch/pytorch/blob/master/caffe2/core/common.h
-#if defined(ONNX_BUILD_SHARED_LIBS) || defined(ONNX_BUILD_MAIN_LIB)
-#define ONNX_API ONNX_EXPORT
+#ifndef ONNX_PROTO_API
+#define ONNX_PROTO_API ONNX_IMPORT
 #else
-#define ONNX_API ONNX_IMPORT
+#define ONNX_PROTO_API ONNX_EXPORT
 #endif
 
 #ifdef ONNX_ML
-- 
2.34.1

